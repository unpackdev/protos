syntax = "proto3";
package unpack.v1.contracts;
option go_package = "github.com/unpackdev/protos/dist/go/contracts;contracts_pb";

// Represents a vulnerability metric.
message VulnerabilityMetric {
    string level = 1;  // Severity level of the vulnerability.
    int32 count = 2;   // Count of vulnerabilities of this severity level.
}

// Represents an element associated with a vulnerability.
message Element {
    string name = 1;             // Name of the element.
    string type = 2;             // Type of the element.
    int32 start = 3;             // Starting position of the element.
    int32 length = 4;            // Length of the element.
    int32 starting_column = 5;   // Starting column of the element.
    int32 ending_column = 6;     // Ending column of the element.
}

// Represents details of a vulnerability.
message Vulnerability {
    string check = 1;                               // Check associated with the vulnerability.
    string impact = 2;                              // Impact of the vulnerability.
    string description = 3;                         // Description of the vulnerability.
    string confidence = 4;                          // Confidence level of the vulnerability detection.
    repeated unpack.v1.contracts.Element elements = 5;  // Elements associated with the vulnerability.
}